<?php



class Skssite_ctrl extends CI_controller {



	public function __construct(){

				parent:: __construct();


				$this->load->model('Insert_model');
				$this->load->model('Sks_cont_mod', 'std');

			}





 public function showcon(){



		$data['row']=$this->std->details();// the details the name of your function in the mode

		$this->load->view('show_contact', $data);

			}

//------------------------------------------------------------------------------------------------



 

 //public function siteadd(){



	//	$dataa['main_content']='siteadd'; // put your view file here 

		//	$this->load->view( 'includes/template' ,  $dataa);



		//}


public function error(){



		

			$this->load->view('error');

		}
	

public function login(){



		

			$this->load->view('admin_login');

		}

	/* function login(){



	 	$dataa['main_content']='admin_login'; // put your view file here 

			$this->load->view( 'includes/template' ,  $dataa);

	 		}*/



function admin_page(){ // Here is the  admin page after logging in.



	 	$dataa['main_content']='admin_page'; // put your view file here 

			$this->load->view( 'includes/template2' ,  $dataa);



	 		}







	 function admin(){



	 	$data=array(



	 		'username'=>$this->input->post('un'),



	 		'password'=>md5($this->input->post('pw')),



	 		

	 		);



	 	$this->db->insert('students');

	 }











	 function validate_credentials(){

        $this->load->model('Sks_cont_mod');

        $data = array(

        		'uname' => $this->input->post('un'),

        		'pword' => md5($this->input->post('pw'))

        		);

        //$result = $this->login_database->login($data);

        $query = $this->Sks_cont_mod->validate($data);

        if($query == TRUE)//if the user's creadential validated

        {

            		$username = $this->input->post('un');

            		$result = $this->Sks_cont_mod->read_user_information($username);

         if ($result != false) {

            $data = array(

                'username' => $this->input->post('un'),
                'password' => $this->input->post('pw'),

               /* 'fname' => $result[0]->firstname,

                'lname' => $result[0]->lastname,*/

                
                'is_logged_in' => true

            );

            $this->session->set_userdata($data);

            redirect('cpanel');

        }

        }

        else{

            $this->error();           

        }

    }




function contactform(){// this is the query to insert into the database table (contact).



	 	$data=array(



	 		'fullname'=>$this->input->post('name'),



	 		'email'=>$this->input->post('email'),



	 		'subject'=>$this->input->post('sub'),



	 		'message'=>$this->input->post('fback'),



	 		

	 		);



	 	$this->db->insert('contact' , $data);



	 	redirect('sksctrl/contact');// this will redirect back to the page that select the data.

	 }



	 function edit($id){
	 		$data['r']=$this->std->getstudentrow($id);
	 		$this->load->view('edit', $data);
	 	}

	 	function saveupdate(){// this is the query to update  the database table (students).
	 			$id=$this->input->post('id');
	 	$data=array(

	 		'fullname'=>$this->input->post('fn'),

	 		'email'=>$this->input->post('email'),

	 		'subject'=>$this->input->post('sub'),

	 		'message'=> ($this->input->post('msg')),

	 		
	 		);
	 		$this->db->where('id',$id);
	 	$this->db->update('contact' , $data);
	 	redirect('cpanel');// this will redirect back to the page that select the data.
	 }


	 	function delete($id){// delete query is only applied into your controllers
	 		$this->db->where('id', $id);
	 		$this->db->delete('contact');
	 		redirect('Skssite_ctrl/admin_page');
	 	}


	

// function to load student registration form.
	 	function reg(){
	 		$this->load->view('v_regform');
	 	}


    function logout(){
    $this->session->unset_userdata=array();
    $this->session->sess_destroy();
    //$data['main_content'] = 'login_form';
    //$this->load->view('login');
    $this->login(); // Make sure you put your function name and not your route name i.e 'login'   
    }


    //here begin payment ctrl
    	function voguepay(){ 


	 	$dataa['main_content']='vpay'; // put your view file here 

			$this->load->view( 'includes/template' ,  $dataa);



	 		}

	 		function voguepay_fail(){ 


	 	$dataa['main_content']='vpay_fail'; // put your view file here 

			$this->load->view( 'includes/template' ,  $dataa);



	 		}


	 		function voguepay_success(){ 



	 	$dataa['main_content']='vpay_success'; // put your view file here 

			$this->load->view( 'includes/template' ,  $dataa);



	 		}


	 		function voguepay_notify(){ // Here is the  admin page after logging in.



	 	$dataa['main_content']='vpay_notify'; // put your view file here 

			$this->load->view( 'includes/template' ,  $dataa);



	 		}

			//above ends payment ctrl


	}



    

 //pls do not put space below your php tags. it will give errors

	 ?>
